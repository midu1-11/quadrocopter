# 四轴飞行器  
## 一.项目简介
四轴飞行器是大三上学期计划做的，陆续一直拖到寒假，目前硬件部分已经全部完成，软件部分写了平衡PID，但参数还在调，目前遥控器只有调参功能。  
## 二.开源链接
演示视频:  未发布
  
hardware文件夹中有原理图的pdf文件、pcb的gerber文件以及遥控器外形的dxf文件  
  
software文件夹中有飞控和遥控器的程序 
  
## 三.开发环境
1. keil stm32开发  
  
2. LaserMaker  遥控器dxf外形文件绘制  
  
3. 立创eda pcb设计  
  
## 四.功能展示
图1 四轴飞行器正面  
![四轴飞行器正面](https://s4.ax1x.com/2022/02/27/bn4HHS.jpg)  
图2 四轴飞行器背面  
![四轴飞行器背面](https://s4.ax1x.com/2022/02/27/bn5jaD.jpg)  
图3 遥控器  
![遥控器](https://s4.ax1x.com/2022/02/27/bnIisP.jpg)  
图4 充电器  
![充电器](https://s4.ax1x.com/2022/02/27/bnIisP.jpg)  
 
## 五.技术详情  
1. 陀螺仪和加速度计采用mpu6050芯片，使用芯片自带DMP姿态解算获取四元数然后计算出俯仰角、翻滚角、偏航角
  
2. 电机采用四个720空心杯电机，使用了三个红蓝线电机、一个黑白线电机、两个正反桨，其中一个红蓝线电机反接相当于黑白线电机，网上没找到这样接的例子，可能会影响飞行效果。实测电机几乎满转才能抵消重力，续航时间不超过十分钟  
  
3. 空心杯电机转速采用mos管配合主控芯片输出的pwm开环控制，但我认为pwm和转速的线性度非常差  
  
4. 遥控器和四轴飞行器采用两个esp8266通信，遥控器的esp8266工作在AP模式，打开wifi并创建服务器(TCP)，四轴飞行器的esp8266工作在STA模式，连接wifi并作为客户端(透传模式)接收服务端发送的消息，虽然这里只用到了单向消息传递，但是是可以双向消息传递的，这种通信方式不占飞控芯片的时间，但是传输有延迟  
  
5. 遥控器配了一个oled屏幕和两个电位器型摇杆，每次循环需要读四路模拟量，这占用了主控芯片的时间(换成数字量的摇杆会更好)。此外，刷新oled也十分占用时间，提高主控芯片的主频或可解决(这里采用的是stm32c6t6，飞控采用的是stm32c8t6)  
  
6. 目前正在调试飞行器姿态平衡的PID，关于悬停，定速等算法有待以后开发  
  
7. 本页面的图片来自于路过图床  
  
## 六.项目的不足及以后可能的改进  
1. 720空心杯红蓝线电机反接代替黑白线电机，四个电机来自两批厂商，都可能会带来问题    

2. 遥控器主频太低，oled刷屏速度慢，测模拟量占用时间，可能会导致反应迟钝，飞行器操控迟钝  
  
3. 未来可能会换无刷电机，打印机架和外壳，不再使用pcb作为机架。  
  
4. 未来可能会加入摄像头无线图传，实现摄像功能  
  
5. 未来可能会换飞控芯片和遥控器芯片，可以参考市面上的飞控  

6. 未来可能会使用蓝牙进行通信，可能提高通信速度降低延迟
